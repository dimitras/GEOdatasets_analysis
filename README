COX expression analysis

All experiments retrieved from GEO were carried out under the same conditions. All microarrays performed on LCLs using an Affymetrix Human HG-Focus Target Array. Samples were treated the same, the platform and protocol used to perform the microarray was the same.


### PART 1 ###

Retrieve GEO datasets to check the variability of expression of a key genes list for the COX pathway.

- Links for studies in GEO:
http://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS2106
http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE1485
http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE5859
http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE10824

- GSM lists (source.R): Parse GSE_family.soft files and creating a custom csv table with a 'GSM-expression values' set per probe. Used the GEOquery lib written in R (http://www2.warwick.ac.uk/fac/sci/moac/people/students/peter_cock/r/geo). COMMENT: Embodied script to run R source by command line (without having to get in the R environment) by passing through arguments.


### PART 2 ###

Find the COX pathway genes through the datasets (GSE as source files).

- Found genes (find_genes.rb): Parse GSM tables with ruby script to find and count the existence of COX pathway genes. Export these genes with their expression values for all samples.

- Gene expression plots (barplot.R): Barplot the average, variance, and standard deviation in gene expression level for COX pathway genes, per experiment and by gene (pending).


### PART 3 ###

Retrieve the respective CEL files for GEO datasets from GEO to process and RMA normalize the Affy CEL files.

- CEL to PCL files (_ProcessToPCL.R): Run Princeton's script for all experiments and get the PCL files in format: Entrezid_at, expression values for all samples (https://bitbucket.org/FunctionLab/arrayprocess/src/7ac17f671ac91381527ad97de377a7c0c4be6a9a/ProcessToPCL.R?at=default). 
NOTE: Used the hgfocus chip lib from brain: http://brainarray.mbni.med.umich.edu/Brainarray/Database/CustomCDF/16.0.0/entrezg.asp


### PART 4 ###

Find the COX pathway genes through the datasets, in PCLs (same datasets but using CEL files as source, as mentioned in step 3).
NOTE: The probe-ids-like in the PCLs are the entrez ids with the probe_id suffix "at".

- Found genes in PCLs (find_coxgenes_in_pcl.R): Locate the COX genes among the csv datasets (PCL files converted to csv first).

- Gene expression plots (pcl_plots.R, pcl_plots_by_gene.R): Barplot the average, variance, and standard deviation in gene expression level for COX pathway genes, per experiment and by gene (pending). Note that the x axis in the plots are the genes (entrez ids).


### PART 5 ###

Check if the GSM ids (samples) are the same through the experiments (used the GSM tables created in step 2)

- GSM ids comparison (compareIDs.R): Get the uniques through the experiments, export a table with all the relations (https://upenn.box.com/s/zormz8yo5tgbkftru4aj)


### PART 6 ###

Retrieve genotype data from hapmap by coriell id (linked to GEO ids) and convert them to ped/map (plink format). 

- Samples: ftp://ftp.ncbi.nlm.nih.gov/hapmap/samples_individuals/ (info about the founders)
- Genotypes: http://hapmap.ncbi.nlm.nih.gov/downloads/genotypes/2010-08_phaseII+III/forward/

- Genotype files with unique rs-id entries in hapmap format (unique_rs_ids.rb):
Filtered all hapmap genotype files to get only the unique rs ids.
IMPORTANT NOTE: the genotype files contain duplicated rs ids with different locations from different origins/ centers (sanger, perlegen, broad, affymetrix, bcm, illumina). Kept the unique rs ids, by merging alleles per sample. Between the duplicated rs entries, compare the alleles like this: 
known-unknown => known
known==known => known
known!=known => unknown
and ignore the location, origin and other fields.

- GM2NA lists (GM_to_NA.rb): Linking GEO expression data with genotypes from HapMap. Actually link the GM ids (GEO sample ids) with the coriell ids (Hapmap sample ids).

- Samples' list (coriell_founders_list.rb): Filtering the coriell ids list by the samples that are the founders. Get the sample-individuals with the coriell ids that correspond to the GEO ids, and also fulfill the criterion of being a founder (0 for a founder).

- PED & MAP files (run_glu.sh): Convert all hapmap genotype files (with merged duplicates) for each sample set (CEU, JPT, YRI, CHB) to ped & map files (plink format) with GluGenetics library and filter them with samples' list (list with those coriell ids that correspond to the GEO ids). RUN shell script to transform by sample group.
REF:
- PLINK: http://hapmap.ncbi.nlm.nih.gov/downloads/genotypes/hapmap3_r3/plink_format/
- GLU: http://code.google.com/p/glu-genetics/
NOTE: May need to cross validate with the inconsistencies.

- filter the genetic data with 5% variance
- specify in genome 100KB +- from  transcription start site (???).


### PART 7 ###

Association analysis to identify genetic variants that influence COX pathway gene expression.

....

- Analysis with Genetic Power Calculator.
- Whole genome association analysis plink toolset.


### PART 8 ###

Analysis with ready eQTL results.

Downloaded the results sets for our genes of interest, from eqtl browser: http://eqtl.uchicago.edu/cgi-bin/gbrowse/eqtl/
The results sets include the Stranger et al. 2007 paper whose data we have retrieved from GEO.

MANUALLY:
- Searched each of the 21 cox genes (only 20 genes found actually), directly on the eqtl browser, like this: *PTGS1*
- Downloaded the gff file by selecting the tracks of interest (specifically the studies we are interested, which were selected according to the tissues of our interest), and excluding entrez genes.

AUTOMATED WAY (selected_eqtl_results_to_gff.rb):
- Downloaded one full gff file that is available at eqtl browser and contains all the data in this browser.
- Filtered the results
1. by our genes of interest
2. by the studies we are interested, which were selected according to the tissues of our interest
3. by score with cutoff set to 7.0

MORE:
also searched results from Dixon et al 2007 http://www.sph.umich.edu/csg/liang/publications/pdf/ng2109.pdf
and did not find any relevant hits (no gene matches)







